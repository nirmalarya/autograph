{
  "name": "Bayer Secure API Architecture",
  "description": "Bayer-compliant REST API with authentication, authorization, and audit logging",
  "category": "api",
  "tags": ["bayer", "api", "security", "oauth2"],
  "bayer_approved": true,
  "compliance_level": "SOC2",
  "mermaid_code": "sequenceDiagram\n    participant User\n    participant API_Gateway\n    participant OAuth2_Server\n    participant API_Service\n    participant Database\n    participant Audit_Log\n    \n    Note over User,Audit_Log: Authentication Flow (OAuth 2.0 + PKCE)\n    \n    User->>API_Gateway: 1. Request Access Token<br/>POST /oauth/token<br/>(client_id, code_verifier)\n    API_Gateway->>OAuth2_Server: 2. Validate Credentials<br/>Azure AD B2C\n    OAuth2_Server-->>API_Gateway: 3. Access Token (JWT)<br/>Refresh Token\n    API_Gateway-->>User: 4. Return Tokens<br/>(access_token, refresh_token)\n    \n    Note over User,Audit_Log: API Request Flow\n    \n    User->>API_Gateway: 5. API Request<br/>GET /api/v1/products<br/>Authorization: Bearer {token}\n    API_Gateway->>API_Gateway: 6. Validate JWT<br/>Check signature, expiry<br/>Extract user_id, roles\n    API_Gateway->>API_Gateway: 7. Rate Limit Check<br/>(100 req/min per user)\n    API_Gateway->>API_Service: 8. Forward Request<br/>+ User Context<br/>+ Request ID\n    API_Service->>API_Service: 9. Authorization Check<br/>User has 'read:products'?\n    API_Service->>Database: 10. Query Data<br/>SELECT * FROM products<br/>WHERE tenant_id = ?\n    Database-->>API_Service: 11. Return Data\n    API_Service->>Audit_Log: 12. Log Access<br/>(user_id, resource, action, timestamp)\n    API_Service-->>API_Gateway: 13. Response Data<br/>+ Security Headers\n    API_Gateway-->>User: 14. JSON Response<br/>+ CORS Headers<br/>+ Rate Limit Headers\n    \n    Note over User,Audit_Log: Security Headers\n    Note right of API_Gateway: X-Frame-Options: DENY<br/>X-Content-Type-Options: nosniff<br/>Strict-Transport-Security: max-age=31536000<br/>X-Request-ID: uuid",
  "security_notes": [
    "OAuth 2.0 with PKCE for authentication",
    "JWT tokens with 1-hour expiry",
    "Refresh tokens with 30-day expiry, rotation on use",
    "Rate limiting: 100 requests/minute per user",
    "Request ID for distributed tracing",
    "All API calls logged to Bayer SIEM",
    "TLS 1.3 required for all connections"
  ],
  "compliance_notes": [
    "Meets Bayer API Security Standards",
    "OAuth 2.0 compliant",
    "GDPR-compliant audit logging",
    "PCI-DSS compliant (if handling payment data)"
  ]
}
